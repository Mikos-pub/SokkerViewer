CREATE ALIAS MILLIS_DAY FOR "pl.pronux.sokker.model.SokkerDate.convertMillisToDay";
CREATE ALIAS MILLIS_WEEK FOR "pl.pronux.sokker.model.SokkerDate.convertMillisToWeek";
ALTER TABLE player_skills ADD COLUMN day INTEGER;
ALTER TABLE player_skills ADD COLUMN week INTEGER;
UPDATE player_skills SET day = MILLIS_DAY(select millis from player_skills as s WHERE s.id_skill = player_skills.id_skill);
UPDATE player_skills SET week = MILLIS_WEEK(select millis from player_skills as s WHERE s.id_skill = player_skills.id_skill);
ALTER TABLE arena ADD COLUMN day INTEGER;
ALTER TABLE arena ADD COLUMN week INTEGER;
UPDATE arena SET day = MILLIS_DAY(select millis from arena as s WHERE s.id = arena.id);
UPDATE arena SET week = MILLIS_WEEK(select millis from arena as s WHERE s.id = arena.id);
ALTER TABLE club_arena_name ADD COLUMN day INTEGER;
ALTER TABLE club_arena_name ADD COLUMN week INTEGER;
UPDATE club_arena_name SET day = MILLIS_DAY(select millis from club_arena_name as s WHERE s.id_data = club_arena_name.id_data);
UPDATE club_arena_name SET week = MILLIS_WEEK(select millis from club_arena_name as s WHERE s.id_data = club_arena_name.id_data);
ALTER TABLE club_data_fanclub ADD COLUMN day INTEGER;
ALTER TABLE club_data_fanclub ADD COLUMN week INTEGER;
UPDATE club_data_fanclub SET day = MILLIS_DAY(select millis from club_data_fanclub as s WHERE s.id_data = club_data_fanclub.id_data);
UPDATE club_data_fanclub SET week = MILLIS_WEEK(select millis from club_data_fanclub as s WHERE s.id_data = club_data_fanclub.id_data);
ALTER TABLE club_data_money ADD COLUMN day INTEGER;
ALTER TABLE club_data_money ADD COLUMN week INTEGER;
UPDATE club_data_money SET day = MILLIS_DAY(select millis from club_data_money as s WHERE s.id_data = club_data_money.id_data);
UPDATE club_data_money SET week = MILLIS_WEEK(select millis from club_data_money as s WHERE s.id_data = club_data_money.id_data);
ALTER TABLE club_name ADD COLUMN day INTEGER;
ALTER TABLE club_name ADD COLUMN week INTEGER;
UPDATE club_name SET day = MILLIS_DAY(select millis from club_name as s WHERE s.id_data = club_name.id_data);
UPDATE club_name SET week = MILLIS_WEEK(select millis from club_name as s WHERE s.id_data = club_name.id_data);
ALTER TABLE junior_skills ADD COLUMN day INTEGER;
ALTER TABLE junior_skills ADD COLUMN week INTEGER;
UPDATE junior_skills SET day = MILLIS_DAY(select millis from junior_skills as s WHERE s.id_skill = junior_skills.id_skill);
UPDATE junior_skills SET week = MILLIS_WEEK(select millis from junior_skills as s WHERE s.id_skill = junior_skills.id_skill);
ALTER TABLE training ADD COLUMN day INTEGER;
ALTER TABLE training ADD COLUMN week INTEGER;
UPDATE training SET day = MILLIS_DAY(select millis from training as s WHERE s.id_training = training.id_training);
UPDATE training SET week = MILLIS_WEEK(select millis from training as s WHERE s.id_training = training.id_training);
ALTER TABLE player_skills ADD COLUMN experience INTEGER DEFAULT 0;
ALTER TABLE player_skills ADD COLUMN teamwork INTEGER DEFAULT 0;
ALTER TABLE player_skills ADD COLUMN discipline INTEGER DEFAULT 0;
UPDATE coach SET job = '1' WHERE job='head';
UPDATE coach SET job = '2' WHERE job='assistant';
UPDATE coach SET job = '3' WHERE job='juniors';
UPDATE coach SET job = '0' WHERE job='none';
ALTER TABLE coach ALTER COLUMN job INTEGER NOT NULL;
UPDATE arena SET location = '1' WHERE location='N';
UPDATE arena SET location = '2' WHERE location='S';
UPDATE arena SET location = '3' WHERE location='W';
UPDATE arena SET location = '4' WHERE location='E';
UPDATE arena SET location = '5' WHERE location='NW';
UPDATE arena SET location = '6' WHERE location='NE';
UPDATE arena SET location = '7' WHERE location='SW';
UPDATE arena SET location = '8' WHERE location='SE';
ALTER TABLE arena ALTER COLUMN location INTEGER NOT NULL;
CREATE MEMORY TABLE NT_PLAYER_SKILLS(ID_SKILL INTEGER GENERATED BY DEFAULT AS IDENTITY(START WITH 0) NOT NULL,NT_ASSISTS INTEGER DEFAULT 0 NOT NULL, NT_GOALS INTEGER DEFAULT 0 NOT NULL, NT_MATCHES INTEGER DEFAULT 0 NOT NULL,NT_CARDS INTEGER DEFAULT 0 NOT NULL, ID_PLAYER_FK BIGINT NOT NULL,MILLIS BIGINT,DAY INTEGER,WEEK INTEGER,CONSTRAINT NT_SKILLS_PKEY PRIMARY KEY(ID_SKILL),CONSTRAINT NT_SKILLS_ID_PLAYER_FK_FKEY FOREIGN KEY(ID_PLAYER_FK) REFERENCES PLAYER(ID_PLAYER) ON DELETE CASCADE);
SET PROPERTY "hsqldb.applog" 1;
SET WRITE_DELAY FALSE;
CREATE MEMORY TABLE transfers (id BIGINT NOT NULL, SELLER_TEAM_ID INTEGER NOT NULL, BUYER_TEAM_ID INTEGER NOT NULL, SELLER_TEAM_NAME VARCHAR NOT NULL, BUYER_TEAM_NAME VARCHAR NOT NULL, PLAYER_ID BIGINT NOT NULL, MILLIS BIGINT NOT NULL, DAY INTEGER NOT NULL, WEEK INTEGER NOT NULL, PRICE INTEGER NOT NULL, PLAYER_VALUE INTEGER NOT NULL, CONSTRAINT transfers_pk PRIMARY KEY(id));
UPDATE training SET type = 8 WHERE type = 7;
UPDATE training SET type = 7 WHERE type = 6;
UPDATE training SET type = 6 WHERE type = 5;
UPDATE training SET type = 5 WHERE type = 4;
UPDATE training SET type = 4 WHERE type = 3;
UPDATE training SET type = 3 WHERE type = 2;
UPDATE training SET type = 2 WHERE type = 1;
UPDATE training SET type = 1 WHERE type = 0;
ALTER TABLE player ADD COLUMN id_club_fk BIGINT;
UPDATE player SET id_club_fk = (SELECT max(id) FROM club);
CREATE TABLE rank( id_data IDENTITY, id_club_fk BIGINT NOT NULL, millis BIGINT, rank DOUBLE NOT NULL, DAY INTEGER, WEEK INTEGER, CONSTRAINT rank_id_data_pk PRIMARY KEY (id_data), CONSTRAINT rank_id_club_fk_fkey FOREIGN KEY (id_club_fk) REFERENCES club (id) ON UPDATE NO ACTION ON DELETE CASCADE);
CREATE INDEX rank ON rank(id_data);
ALTER TABLE club ADD COLUMN date_created BIGINT;
ALTER TABLE club ADD COLUMN juniors_max INTEGER;
ALTER TABLE training ADD COLUMN reported BOOLEAN DEFAULT true;
UPDATE training SET reported = false;
UPDATE system SET version = 5;
